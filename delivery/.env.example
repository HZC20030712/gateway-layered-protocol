# Gateway 分层协议 - 配置文件

# ==================== 网关基础配置 ====================

# 网关角色：main | auxiliary | branch
GATEWAY_ROLE=main

# 网关唯一 ID
GATEWAY_ID=gw-main-001

# 监听端口
GATEWAY_PORT=18789

# 管理端口（仅主网关）
MANAGEMENT_PORT=18790

# ==================== 安全配置 ====================

# 主网关 Token（用于辅网关认证）
# 生成方法：openssl rand -hex 32
MAIN_GATEWAY_TOKEN=your-secure-token-here-change-in-production

# Token 刷新间隔（秒），0 表示不刷新
TOKEN_REFRESH_INTERVAL=3600

# ==================== WSS 加密配置 ====================

# 启用 WSS 加密（true/false）
WSS_ENABLED=true

# SSL 证书路径
SSL_KEY_PATH=./certs/server.key
SSL_CERT_PATH=./certs/server.crt

# SSL 证书密码（如果有）
# SSL_KEY_PASSWORD=

# ==================== IP 白名单配置 ====================

# IP 白名单（逗号分隔，支持 CIDR 格式）
# 示例：192.168.1.0/24,10.0.0.1,127.0.0.1
ALLOWED_GATEWAY_IPS=127.0.0.1,192.168.1.0/24

# 启用 IP 白名单（true/false）
IP_WHITELIST_ENABLED=true

# ==================== 消息签名配置 ====================

# 启用消息签名（true/false）
MESSAGE_SIGNATURE_ENABLED=true

# 签名密钥
SIGNATURE_SECRET=your-signature-secret-here-change-in-production

# 签名算法：hmac-sha256 | hmac-sha512
SIGNATURE_ALGORITHM=hmac-sha256

# ==================== 速率限制配置 ====================

# 启用速率限制（true/false）
RATE_LIMIT_ENABLED=true

# 注册频率限制（每分钟最大次数）
RATE_LIMIT_REGISTER_MAX=10

# 心跳频率限制（每 10 秒最大次数）
RATE_LIMIT_HEARTBEAT_MAX=5

# 任务下发频率限制（每秒最大次数）
RATE_LIMIT_TASK_MAX=100

# ==================== 审计日志配置 ====================

# 启用审计日志（true/false）
AUDIT_LOG_ENABLED=true

# 日志目录
AUDIT_LOG_DIR=./logs

# 日志轮转：按大小（MB）
AUDIT_LOG_MAX_SIZE=100

# 日志轮转：按天数
AUDIT_LOG_MAX_DAYS=30

# 日志级别：debug | info | warn | error
AUDIT_LOG_LEVEL=info

# ==================== 主网关配置（仅辅网关） ====================

# 主网关 URL（辅网关必填）
# MAIN_GATEWAY_URL=wss://localhost:18790

# 主网关 Token（辅网关必填）
# MAIN_GATEWAY_TOKEN=your-token

# ==================== 设备指纹配置 ====================

# 启用设备指纹验证（true/false）
DEVICE_FINGERPRINT_ENABLED=false

# 设备指纹（可选，自动生成）
# DEVICE_FINGERPRINT=

# ==================== 其他配置 ====================

# 心跳间隔（秒）
HEARTBEAT_INTERVAL=30

# 心跳超时（秒）
HEARTBEAT_TIMEOUT=90

# 重连间隔（秒）
RECONNECT_INTERVAL=5

# 最大重连次数（0 表示无限）
MAX_RECONNECT_ATTEMPTS=0
