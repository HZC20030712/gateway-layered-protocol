# Gateway Layered Protocol - ä½¿ç”¨æ•™ç¨‹

## ğŸ¯ 5 åˆ†é’Ÿä¸Šæ‰‹æŒ‡å—

### æ­¥éª¤ 1: å¯åŠ¨ä¸»ç½‘å…³

æ‰“å¼€ç»ˆç«¯ 1ï¼š
```bash
cd delivery
npm run dev:main
```

**çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºè¡¨ç¤ºæˆåŠŸ**ï¼š
```
==================================================
  Gateway åˆ†å±‚åè®® - ä¸»ç½‘å…³
==================================================
ç½‘å…³ ID: gw-main-001
ç›‘å¬ç«¯å£ï¼š18789
ç®¡ç†ç«¯å£ï¼š18790
==================================================
[Gateway] å¯åŠ¨ main ç½‘å…³ (gw-main-001)
[MainGateway] ç›‘å¬ç«¯å£ 18790
[Gateway] ç½‘å…³å¯åŠ¨æˆåŠŸ
ä¸»ç½‘å…³å¯åŠ¨æˆåŠŸï¼ŒæŒ‰ Ctrl+C åœæ­¢
```

---

### æ­¥éª¤ 2: å¯åŠ¨è¾…ç½‘å…³

æ‰“å¼€ç»ˆç«¯ 2ï¼š
```bash
cd delivery
npm run dev:aux
```

**çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºè¡¨ç¤ºæˆåŠŸ**ï¼š
```
[Gateway] å¯åŠ¨ auxiliary ç½‘å…³ (gw-auxiliary-001)
[AuxGateway] å·²è¿æ¥åˆ°ä¸»ç½‘å…³ï¼šws://localhost:18790
[AuxGateway] æ³¨å†ŒæˆåŠŸï¼šgw-auxiliary-001
```

---

### æ­¥éª¤ 3: æ‰“å¼€ Web ç®¡ç†ç•Œé¢

æµè§ˆå™¨è®¿é—®ï¼š**http://localhost:5173**

**é»‘è‰²é£æ ¼ç®¡ç†ç•Œé¢**ï¼š
- ğŸ“Š å®æ—¶ç»Ÿè®¡å¡ç‰‡ï¼ˆç½‘å…³æ•°/ä»»åŠ¡æ•°ï¼‰
- ğŸ“¡ ç½‘å…³åˆ—è¡¨ï¼ˆåœ¨çº¿çŠ¶æ€/CPU/å†…å­˜ï¼‰
- ğŸ“¤ ä»»åŠ¡å‘ä¸‹é¢æ¿ï¼ˆç›®æ ‡ç½‘å…³/Agent/å‘½ä»¤ï¼‰
- ğŸ“ å®æ—¶æ—¥å¿—

---

### æ­¥éª¤ 4: æµ‹è¯•ä»»åŠ¡ä¸‹å‘

**æ–¹æ³• 1: ä½¿ç”¨ Web UI**
1. æ‰“å¼€ http://localhost:5173
2. é€‰æ‹©ç›®æ ‡ç½‘å…³
3. é€‰æ‹© Agent IDï¼ˆdev/ops/content ç­‰ï¼‰
4. é€‰æ‹©å‘½ä»¤ï¼ˆcode-review/test/deployï¼‰
5. ç‚¹å‡»"å‘é€ä»»åŠ¡"

**æ–¹æ³• 2: ä½¿ç”¨ API**
```typescript
import { MainGateway } from './main-gateway';

const main = MainGateway.create({
  gatewayId: 'gw-main-001',
  port: 18789,
  managementPort: 18790,
});

await main.start();

// ä¸‹å‘ä»»åŠ¡
await main.dispatchTask('gw-auxiliary-001', {
  taskId: 'task-001',
  agentId: 'dev',
  command: 'code-review',
  params: { repo: 'my-repo' },
});

// å¹¿æ’­ä»»åŠ¡
await main.broadcastTask({
  taskId: 'task-002',
  agentId: 'main',
  command: 'status-report',
});
```

---

### æ­¥éª¤ 5: è§‚å¯Ÿç»“æœ

**ä¸»ç½‘å…³ç»ˆç«¯** åº”æ˜¾ç¤ºï¼š
```
[ä¸»ç½‘å…³] ç½‘å…³æ³¨å†Œï¼šgw-auxiliary-001 (auxiliary)
[ä¸»ç½‘å…³] ä»»åŠ¡ä¸‹å‘ï¼štask-001
[ä¸»ç½‘å…³] ä»»åŠ¡ç»“æœï¼štask-001 (success)
```

**è¾…ç½‘å…³ç»ˆç«¯** åº”æ˜¾ç¤ºï¼š
```
[AuxGateway] æ³¨å†ŒæˆåŠŸï¼šgw-auxiliary-001
[è¾…ç½‘å…³] æ”¶åˆ°ä»»åŠ¡ï¼štask-001 (dev/code-review)
[AuxGateway] å‘é€ä»»åŠ¡ç»“æœï¼štask-001
```

**Web UI** åº”æ˜¾ç¤ºï¼š
- å·²è¿æ¥ç½‘å…³ï¼š1
- ä»»åŠ¡åˆ—è¡¨ï¼štask-001 âœ… å®Œæˆ
- å®æ—¶æ—¥å¿—ï¼šä»»åŠ¡å®Œæˆæ—¥å¿—

---

## ğŸ“‹ å®Œæ•´ç¤ºä¾‹

### ç¤ºä¾‹ 1: ä»£ç å®¡æŸ¥ä»»åŠ¡

```typescript
// ä¸»ç½‘å…³ä¸‹å‘ä»£ç å®¡æŸ¥ä»»åŠ¡
await main.dispatchTask('gw-auxiliary-001', {
  taskId: 'review-001',
  agentId: 'dev',
  command: 'code-review',
  params: {
    repo: 'opencloud-migration',
    pr: 123,
  },
});
```

### ç¤ºä¾‹ 2: æ‰¹é‡éƒ¨ç½²ä»»åŠ¡

```typescript
// å¹¿æ’­åˆ°æ‰€æœ‰è¾…ç½‘å…³
await main.broadcastTask({
  taskId: 'deploy-001',
  agentId: 'ops',
  command: 'deploy',
  params: {
    environment: 'production',
    version: '1.0.0',
  },
});
```

### ç¤ºä¾‹ 3: çŠ¶æ€æŠ¥å‘Šæ”¶é›†

```typescript
// æ”¶é›†æ‰€æœ‰ Agent çŠ¶æ€
await main.broadcastTask({
  taskId: 'status-001',
  agentId: 'main',
  command: 'status-report',
});
```

---

## ğŸ¨ Web UI åŠŸèƒ½

### ç»Ÿè®¡å¡ç‰‡
- **å·²è¿æ¥ç½‘å…³**: å®æ—¶æ˜¾ç¤ºåœ¨çº¿ç½‘å…³æ•°é‡
- **æ´»è·ƒä»»åŠ¡**: æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡æ•°
- **ä»Šæ—¥å®Œæˆ**: å·²å®Œæˆä»»åŠ¡æ€»æ•°
- **é”™è¯¯æ•°**: é”™è¯¯ç»Ÿè®¡

### ç½‘å…³åˆ—è¡¨
- ç½‘å…³ ID
- è§’è‰²ï¼ˆauxiliary/branchï¼‰
- çŠ¶æ€ï¼ˆğŸŸ¢ åœ¨çº¿ / ğŸ”´ ç¦»çº¿ï¼‰
- CPU ä½¿ç”¨ç‡
- å†…å­˜ä½¿ç”¨ç‡
- æœ€åå¿ƒè·³æ—¶é—´

### ä»»åŠ¡å‘ä¸‹é¢æ¿
- ç›®æ ‡ç½‘å…³é€‰æ‹©
- Agent ID é€‰æ‹©ï¼ˆ8 ä¸ªè§’è‰²ï¼‰
- å‘½ä»¤é€‰æ‹©
- JSON å‚æ•°è¾“å…¥
- å‘é€æŒ‰é’®

### å®æ—¶æ—¥å¿—
- æ—¶é—´æˆ³
- æ—¥å¿—ç±»å‹ï¼ˆä¿¡æ¯/æˆåŠŸ/è­¦å‘Š/é”™è¯¯ï¼‰
- æ—¥å¿—å†…å®¹
- é¢œè‰²åŒºåˆ†

---

## ğŸ§ª æµ‹è¯•æ¸…å•

| æµ‹è¯•é¡¹ | é¢„æœŸç»“æœ | çŠ¶æ€ |
|--------|----------|------|
| ä¸»ç½‘å…³å¯åŠ¨ | ç›‘å¬ 18790 ç«¯å£ | â¬œ |
| è¾…ç½‘å…³å¯åŠ¨ | è¿æ¥åˆ°ä¸»ç½‘å…³ | â¬œ |
| ç½‘å…³æ³¨å†Œ | æ³¨å†ŒæˆåŠŸæ—¥å¿— | â¬œ |
| å¿ƒè·³ä¿æ´» | 30 ç§’å¿ƒè·³ | â¬œ |
| ä»»åŠ¡ä¸‹å‘ | ä»»åŠ¡åˆ°è¾¾è¾…ç½‘å…³ | â¬œ |
| ä»»åŠ¡ç»“æœ | ç»“æœè¿”å›ä¸»ç½‘å…³ | â¬œ |
| Web UI è¿æ¥ | æ˜¾ç¤ºå·²è¿æ¥ | â¬œ |
| Web UI å‘ä»»åŠ¡ | ä»»åŠ¡æˆåŠŸæ‰§è¡Œ | â¬œ |

---

## ğŸ“ 8 äººå›¢é˜Ÿåä½œ

| è§’è‰² | æµ‹è¯•èŒè´£ |
|------|----------|
| **main** | æ€»è°ƒåº¦ + æµ‹è¯•ç›‘ç®¡ |
| **dev** | åç«¯åŠŸèƒ½æµ‹è¯• |
| **design** | å‰ç«¯ UI æµ‹è¯• |
| **ops** | éƒ¨ç½²é…ç½®æµ‹è¯• |
| **security** | å®‰å…¨åŠŸèƒ½æµ‹è¯• |
| **content** | æ–‡æ¡£å®Œå–„ |
| **growth** | æ€§èƒ½æµ‹è¯• |
| **finance** | æˆæœ¬è¯„ä¼° |

---

## ğŸš¨ å¸¸è§é—®é¢˜

### Q1: è¾…ç½‘å…³è¿æ¥å¤±è´¥
**A**: æ£€æŸ¥ä¸»ç½‘å…³æ˜¯å¦å¯åŠ¨ï¼Œç«¯å£ 18790 æ˜¯å¦ç›‘å¬

### Q2: Web UI æ— æ³•è®¿é—®
**A**: è¿è¡Œ `npm run web:dev` å¯åŠ¨å‰ç«¯

### Q3: ä»»åŠ¡ä¸‹å‘æ— å“åº”
**A**: æ£€æŸ¥ç½‘å…³è¿æ¥çŠ¶æ€ï¼ŒæŸ¥çœ‹æ—¥å¿—

---

**ç‰ˆæœ¬**: v1.0.0  
**æ›´æ–°**: 2026-02-26  
**GitHub**: https://github.com/HZC20030712/gateway-layered-protocol
